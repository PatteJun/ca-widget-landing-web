---
import ProcessStep from './ProcessStep.astro';
import { getLangFromUrl, useTranslations } from '../../i18n/ui';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const steps = [
  {
    id: 1,
    title: t('process.step1.title'),
    description: t('process.step1.description'),
    icon: `<svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
    </svg>`
  },
  {
    id: 2,
    title: t('process.step2.title'),
    description: t('process.step2.description'),
    icon: `<svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z" />
    </svg>`
  },
  {
    id: 3,
    title: t('process.step3.title'),
    description: t('process.step3.description'),
    icon: `<svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
    </svg>`
  },
  {
    id: 4,
    title: t('process.step4.title'),
    description: t('process.step4.description'),
    icon: `<svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
    </svg>`
  },
  {
    id: 5,
    title: t('process.step5.title'),
    description: t('process.step5.description'),
    icon: `<svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4" />
    </svg>`
  },
  {
    id: 6,
    title: t('process.step6.title'),
    description: t('process.step6.description'),
    icon: `<svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z" />
    </svg>`
  }
];
---

<section class="py-24 bg-white relative overflow-hidden">
  <div class="max-w-7xl mx-auto px-6 lg:px-8">
    <div class="text-center max-w-3xl mx-auto mb-16">
      <h2 class="text-4xl font-bold tracking-tight text-primary-text mb-6">
        {t('process.title')}
      </h2>
      <p class="text-lg text-secondary-text">
        {t('process.description')}
      </p>
    </div>

    <div class="relative">
      <!-- Animated dot that moves through the process -->
      <div id="processDot" class="absolute w-4 h-4 bg-primary rounded-full shadow-lg hidden md:block" style="top: 40px; left: 0;">
        <div class="absolute inset-0 bg-primary rounded-full animate-ping opacity-75"></div>
      </div>

      <!-- Connection lines -->
      <div class="absolute top-[52px] left-0 w-full h-0.5 bg-gray-100 -z-10 hidden md:block"></div>

      <!-- Process steps -->
      <div class="grid md:grid-cols-3 lg:grid-cols-6 gap-8 mb-16">
        {steps.map(step => <ProcessStep {...step} />)}
      </div>

      <!-- ValueCheck App Explainer -->
      <div class="max-w-2xl mx-auto mt-16 bg-gray-50 rounded-xl p-6">
        <div class="flex items-start gap-4">
          <div class="w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center flex-shrink-0">
            <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
          </div>
          <div>
            <h3 class="text-lg font-semibold text-primary-text mb-2">
              {t('process.valuecheck.title')}
            </h3>
            <p class="text-sm text-secondary-text leading-relaxed" set:html={t('process.valuecheck.description')} />
          </div>
        </div>
      </div>
    </div>
  </div>
</section>